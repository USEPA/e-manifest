# Authentication

## Pre-requisites

Users looking to use the RCRAInfo API need to register and obtain the necessary permissions for the site they're looking to operate as. For infomation on regsitration and permission levels, see the chanpter on [registration](../Intro/registration.md).

## API Id and Keys

The system uses a combination of API Id and API key for user authentication and authorization. The API Id and key (credentials) are generated by the RCRAInfo/e-Manifest application. An API Id/key pair is unique to a user, however the same API Id/key pair is used for all EPA sites that the user has (Site Manager) access to.

[Site Managers](../Intro/registration.md#permission-levels) are the only permission level that can generate API credentials in RCRAInfo. API Id/key pairs do not expire, however, RCRAInfo application passwords (the password used to log into RCRAInfo through a browser) expire every 90 days. The Site Manager that owns the API Id/API key pair must properly maintain account.

User can regenerator new API keys if their key is lost, is compromised, or need to be rotated. An API Id/key pair is terminated is the user account is deactivated or no longer has Site Manager level access for any EPA site. API ID are static.

## Security Tokens

All services (except [Authenticate](#authenticate-service)) require a security.
To obtain a security token, users must utilize the [Authentication (auth)](#authenticate-service) service, which returns a JSON Web Token (JWT) and an expiration date. All subsequent requests must include the JWT as an HTTP header under the `Authorization` key with a value of `Bearer` plus the provided security token.

For example, an HTTP requiest to the [federal-waste-codes]() endpoint would include...

```http
GET /api/v1/federal-waste-codes HTTP/1.1
Host: rcrainfo.epa.gov
Authorization: Bearer theSecurityTokenObtainedFromTheAuthEndpoint
Accept: application/json
...
```

### Expirations and Refreshing Tokens

Security tokens expire after 20 minutes. The expiration time is included in the response from the [Authenticate service](#authenticate-service). Currently, RCRAinfo does not provide refresh tokens or a method to obtain a new tokens without performing a complete login (i.e., using the [Authentication Service](#authenticate-service)).

Expiration datetime follows the ISO 8601 profile, the international standard for representing dates and times. Times are expressed in Coordinated Universal Time (UTC) using the [time zone offset designator ("+hh:mm")](https://www.w3.org/TR/NOTE-datetime) down to the millisecond.

```json
{
  "expiration": "2023-05-10T19:10:05.923+00:00"
  "ISOformats": "YYYY-MM-DDThh:mm:ss.sTZD"
}
```

## Authenticate Service

Authenticates the user and returns the Security Token. The Security token is used on all subsequent
calls and is submitted in the HTTP header using the Authorization in the Key with a value of Bearer

### parameters

- API Id: API ID generated through the RCRAInfo web application. This is not the user's username.
- API key: API key generated through the RCRAInfo web application. Keys can be regenerated when necessary.

### Service Invocation Example

### Response Body Example

```json
{
"token":
"eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiI2ZjdhOTg0OC0zNWE1LTQ4NzQtOTI4Zi0xMmZjM2RlZjFhMz
MiLCJhcGlUb2tlbkNsYWltIjoie1xuICBcImFwaUlkXCIgOiBcIjZmN2E5ODQ4LTM1YTUtNDg3NC05Mj
hmLTEyZmMzZGVmMWEzM1wiLFxuICBcInByb2ZpbGVcIiA6IHtcbiAgICBcInVzZXJJZFwiIDogXCJEQ
VZJRERVTkRVQVwiLFxuICAgIFwic3RhdHVzXCIgOiBcIkFjdGl2ZVwiLFxuICAgIFwibGFzdExvZ2luRGF0
ZVwiIDogXCIyMDE3LTA2LTIyVDIyOjU2OjA5LjAwMCswMDAwXCIsXG4gICAgXCJzZWN1cml0eUFnc
mVlbWVudERhdGVcIiA6IG51bGwsXG4gICAgXCJwYXNzd29yZFJlc2V0RGF0ZVwiIDogbnVsbCxcbiA
gICBcInBhc3N3b3JkU3RhdHVzXCIgOiBcIkFjdGl2ZVwiLFxuICAgIFwiY29udGFjdFwiIDoge1xuICAgIC
AgXCJ0aXRsZVwiIDogXCJhc2RmYXNkZlwiLFxuICAgICAgXCJmaXJzdE5hbWVcIiA6IFwiRGF2aWRcIix
cbiAgICAgIFwibWlkZGxlSW5pdGlhbFwiIDogXCJKXCIsXG4gICAgICBcImxhc3ROYW1lXCIgOiBcIkR1b
mR1YVwiLFxuICAgICAgXCJwaG9uZVwiIDogXCIzMDEtMzUxLTk5MjJcIixcbiAgICAgIFwicGhvbmVFe
HRlbnNpb25cIiA6IFwiNzk1OThcIixcbiAgICAgIFwib3JnYW5pemF0aW9uXCIgOiB7XG4gICAgICAgIF
wiaWRcIiA6IDEyLFxuICAgICAgICBcInRleHRcIiA6IFwiQ0dJXCIsXG4gICAgICAgIFwiY2R4T3JnYW5pe
mF0aW9uSWRcIiA6IDE3MDk2LFxuICAgICAgICBcIm9yZ2FuaXphdGlvblR5cGVcIiA6IFwiQ0RYXCJcb
iAgICAgIH0sXG4gICAgICBcImNvbnRyYWN0b3JcIiA6IGZhbHNlLFxuICAgICAgXCJhZGRyZXNzMVwiI
DogXCIxMzI5IEUgU1QgU0VcIixcbiAgICAgIFwiYWRkcmVzczJcIiA6IG51bGwsXG4gICAgICBcImNpdH
lcIiA6IFwiRkFJUkZBWFwiLFxuICAgICAgXCJzdGF0ZVwiIDoge1xuICAgICAgICBcInJlZ2lvblwiIDogXCIw
M1wiLFxuICAgICAgICBcImRlZmF1bHRUaGlyZENoYXJhY3RlclwiIDogXCJSXCIsXG4gICAgICAgIFwia
WRcIiA6IDE1LFxuICAgICAgICBcImNvZGVcIiA6IFwiVkFcIixcbiAgICAgICAgXCJkZXNjcmlwdGlvblwiID
ogXCJWSVJHSU5JQVwiLFxuICAgICAgICBcIm5hbWVcIiA6IFwiVklSR0lOSUFcIixcbiAgICAgICAgXCJhY
3RpdmVcIiA6IHRydWUsXG4gICAgICAgIFwidXNhZ2VcIiA6IFwiMVwiLFxuICAgICAgICBcInVzZXJJZFw
iIDogbnVsbCxcbiAgICAgICAgXCJsYXN0Q2hhbmdlXCIgOiBcIjIwMTctMDItMTNcIixcbiAgICAgICAgXC
JoZWxwTm90ZXNcIiA6IFwiIFwiLFxuICAgICAgICBcImFjdGl2aXR5TG9jYXRpb25cIiA6IFwiSFFcIlxuICA
gICAgfSxcbiAgICAgIFwiemlwXCIgOiBcIjIyMDMzXCIsXG4gICAgICBcImxlZ2FjeVVzZXJJZFwiIDogbnVs
bCxcbiAgICAgIFwiZW1haWxcIiA6IFwiZGF2aWRAZHVuZHVhLmNvbVwiLFxuICAgICAgXCJ1c2VyT3J
nYW5pemF0aW9uSWRcIiA6IDU1MDY2LFxuICAgICAgXCJ1c2VyUm9sZUlkXCIgOiAxMTk4MDQsXG
4gICAgICBcImlkXCIgOiAyLFxuICAgICAgXCJjcmVhdGVkRGF0ZVwiIDogXCIyMDE3LTA2LTE5VDIyOj
M4OjUxLjAwMCswMDAwXCIsXG4gICAgICBcInVwZGF0ZWREYXRlXCIgOiBcIjIwMTctMDYtMjJUMjI
6NTY6MDkuMDAwKzAwMDBcIlxuICAgIH0sXG4gICAgXCJwcm9maWxlVHlwZVwiIDogXCJDRFhcIix
cbiAgICBcInNwb25zb3JcIiA6IG51bGwsXG4gICAgXCJpZFwiIDogMixcbiAgICBcImNyZWF0ZWREYXR
lXCIgOiBcIjIwMTctMDYtMTlUMjI6Mzg6NTEuMDAwKzAwMDBcIixcbiAgICBcInVwZGF0ZWREYXRlX
CIgOiBudWxsXG4gIH0sXG4gIFwicGVybWlzc2lvbnNcIiA6IFsgXSxcbiAgXCJzaXRlUGVybWlzc2lvbnN
cIiA6IFsgeyB9LCB7IH0gXVxufSIsImV4cCI6MTQ5ODI1OTc0NX0.xw_PGyN6for1GHwf6zqp0OJS10h
wK8jEgRyRI0JpFUducwDKj5paWRTEsCky_06pryEve3Yw2w1bbBzqGdSnnw ",
"expiration": "2017-06-23T23:15:45.095+0000"
}

```
